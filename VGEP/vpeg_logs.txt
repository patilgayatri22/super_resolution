Windows PowerShell
Copyright (C) Microsoft Corporation. All rights reserved.

Install the latest PowerShell for new features and improvements! https://aka.ms/PSWindows

PS C:\windows\system32> docker run --rm -it -v C:\NPU_Projects:/work -w /work mobilint/qbcompiler:v0.9.0.2-cpu bash
root@40e9fbed9b89:/work# python - << 'PY'
import os, glob, numpy as np
from PIL import Image
import onnx
from qubee.calibration import make_calib_man
from qubee import mxq_compile

MODEL="vpeg_nano.onnx"
SRC  ="calib_imgs_gayatri"
CAL  ="calib_sr_gayatri_npy"

# pre_fn: RGB -> 256x256 -> float32 [0,1] (HWC)
def pre_fn(p):
    im=Image.open(p).convert("RGB").resize((256,256), Image.BICUBIC)
    return np.asarray(im, np.float32)/255.0

# clean + build calibration with official maker (required folder structure)
if os.path.isdir(CAL):
    import shutil; shutil.rmtree(CAL)
make_calib_man(pre_ftn=pre_fn,
               data_dir=SRC,
               save_dir=".",
               save_name=CAL,
               max_size=len(glob.glob(os.path.join(SRC,"*.png"))))

# detect input name & layout -> feed_dict
m=onnx.load(MODEL); vi=m.graph.input[0]
iname=vi.name
dims=[d.dim_value or 1 for d in vi.type.tensor_type.shape.dim]
if len(dims)==4 and dims[1] in (1,3):
PYint("OK") backend="onnx")eg_nano.mxq",,r itself)2)}         # NHWC
Traceback (most recent call last):
  File "<stdin>", line 4, in <module>
ModuleNotFoundError: No module named 'qubee'
root@40e9fbed9b89:/work# pip install --no-input /work/qubee-0.10.0.0+aries2-py3-none-any.whl onnx pillow numpy
Processing ./qubee-0.10.0.0+aries2-py3-none-any.whl
Requirement already satisfied: onnx in /usr/local/lib/python3.10/dist-packages (1.16.2)
Requirement already satisfied: pillow in /usr/local/lib/python3.10/dist-packages (11.1.0)
Requirement already satisfied: numpy in /usr/local/lib/python3.10/dist-packages (1.26.0)
Requirement already satisfied: torch>=1.10.1 in /usr/local/lib/python3.10/dist-packages (from qubee==0.10.0.0+aries2) (2.4.1)
Requirement already satisfied: tensorflow>=2.9 in /usr/local/lib/python3.10/dist-packages (from qubee==0.10.0.0+aries2) (2.17.0)
Requirement already satisfied: PyYAML in /usr/local/lib/python3.10/dist-packages (from qubee==0.10.0.0+aries2) (6.0.2)
Requirement already satisfied: torchvision>=0.11.2 in /usr/local/lib/python3.10/dist-packages (from qubee==0.10.0.0+aries2) (0.19.1)
Requirement already satisfied: typeguard in /usr/local/lib/python3.10/dist-packages (from qubee==0.10.0.0+aries2) (4.4.1)
Requirement already satisfied: msgpack in /usr/local/lib/python3.10/dist-packages (from qubee==0.10.0.0+aries2) (1.1.0)
Requirement already satisfied: pycocotools in /usr/local/lib/python3.10/dist-packages (from qubee==0.10.0.0+aries2) (2.0.8)
Requirement already satisfied: protobuf>=3.20.2 in /usr/local/lib/python3.10/dist-packages (from onnx) (4.25.5)
Requirement already satisfied: gast!=0.5.0,!=0.5.1,!=0.5.2,>=0.2.1 in /usr/local/lib/python3.10/dist-packages (from tensorflow>=2.9->qubee==0.10.0.0+aries2) (0.6.0)
Requirement already satisfied: keras>=3.2.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow>=2.9->qubee==0.10.0.0+aries2) (3.8.0)
Requirement already satisfied: requests<3,>=2.21.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow>=2.9->qubee==0.10.0.0+aries2) (2.32.3)
Requirement already satisfied: astunparse>=1.6.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow>=2.9->qubee==0.10.0.0+aries2) (1.6.3)
Requirement already satisfied: google-pasta>=0.1.1 in /usr/local/lib/python3.10/dist-packages (from tensorflow>=2.9->qubee==0.10.0.0+aries2) (0.2.0)
Requirement already satisfied: absl-py>=1.0.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow>=2.9->qubee==0.10.0.0+aries2) (2.1.0)
Requirement already satisfied: tensorboard<2.18,>=2.17 in /usr/local/lib/python3.10/dist-packages (from tensorflow>=2.9->qubee==0.10.0.0+aries2) (2.17.1)
Requirement already satisfied: typing-extensions>=3.6.6 in /usr/local/lib/python3.10/dist-packages (from tensorflow>=2.9->qubee==0.10.0.0+aries2) (4.12.2)
Requirement already satisfied: h5py>=3.10.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow>=2.9->qubee==0.10.0.0+aries2) (3.12.1)
Requirement already satisfied: packaging in /usr/local/lib/python3.10/dist-packages (from tensorflow>=2.9->qubee==0.10.0.0+aries2) (24.2)
Requirement already satisfied: ml-dtypes<0.5.0,>=0.3.1 in /usr/local/lib/python3.10/dist-packages (from tensorflow>=2.9->qubee==0.10.0.0+aries2) (0.4.1)
Requirement already satisfied: flatbuffers>=24.3.25 in /usr/local/lib/python3.10/dist-packages (from tensorflow>=2.9->qubee==0.10.0.0+aries2) (24.12.23)
Requirement already satisfied: grpcio<2.0,>=1.24.3 in /usr/local/lib/python3.10/dist-packages (from tensorflow>=2.9->qubee==0.10.0.0+aries2) (1.69.0)
Requirement already satisfied: libclang>=13.0.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow>=2.9->qubee==0.10.0.0+aries2) (18.1.1)
Requirement already satisfied: opt-einsum>=2.3.2 in /usr/local/lib/python3.10/dist-packages (from tensorflow>=2.9->qubee==0.10.0.0+aries2) (3.4.0)
Requirement already satisfied: setuptools in /usr/lib/python3/dist-packages (from tensorflow>=2.9->qubee==0.10.0.0+aries2) (59.6.0)
Requirement already satisfied: termcolor>=1.1.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow>=2.9->qubee==0.10.0.0+aries2) (2.5.0)
Requirement already satisfied: six>=1.12.0 in /usr/lib/python3/dist-packages (from tensorflow>=2.9->qubee==0.10.0.0+aries2) (1.16.0)
Requirement already satisfied: tensorflow-io-gcs-filesystem>=0.23.1 in /usr/local/lib/python3.10/dist-packages (from tensorflow>=2.9->qubee==0.10.0.0+aries2) (0.37.1)
Requirement already satisfied: wrapt>=1.11.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow>=2.9->qubee==0.10.0.0+aries2) (1.17.2)
Requirement already satisfied: nvidia-cublas-cu12==12.1.3.1 in /usr/local/lib/python3.10/dist-packages (from torch>=1.10.1->qubee==0.10.0.0+aries2) (12.1.3.1)
Requirement already satisfied: jinja2 in /usr/local/lib/python3.10/dist-packages (from torch>=1.10.1->qubee==0.10.0.0+aries2) (3.1.5)
Requirement already satisfied: nvidia-cuda-runtime-cu12==12.1.105 in /usr/local/lib/python3.10/dist-packages (from torch>=1.10.1->qubee==0.10.0.0+aries2) (12.1.105)
Requirement already satisfied: sympy in /usr/local/lib/python3.10/dist-packages (from torch>=1.10.1->qubee==0.10.0.0+aries2) (1.13.3)
Requirement already satisfied: nvidia-curand-cu12==10.3.2.106 in /usr/local/lib/python3.10/dist-packages (from torch>=1.10.1->qubee==0.10.0.0+aries2) (10.3.2.106)
Requirement already satisfied: nvidia-cufft-cu12==11.0.2.54 in /usr/local/lib/python3.10/dist-packages (from torch>=1.10.1->qubee==0.10.0.0+aries2) (11.0.2.54)
Requirement already satisfied: triton==3.0.0 in /usr/local/lib/python3.10/dist-packages (from torch>=1.10.1->qubee==0.10.0.0+aries2) (3.0.0)
Requirement already satisfied: nvidia-cusparse-cu12==12.1.0.106 in /usr/local/lib/python3.10/dist-packages (from torch>=1.10.1->qubee==0.10.0.0+aries2) (12.1.0.106)
Requirement already satisfied: nvidia-cudnn-cu12==9.1.0.70 in /usr/local/lib/python3.10/dist-packages (from torch>=1.10.1->qubee==0.10.0.0+aries2) (9.1.0.70)
Requirement already satisfied: networkx in /usr/local/lib/python3.10/dist-packages (from torch>=1.10.1->qubee==0.10.0.0+aries2) (3.4.2)
Requirement already satisfied: fsspec in /usr/local/lib/python3.10/dist-packages (from torch>=1.10.1->qubee==0.10.0.0+aries2) (2024.9.0)
Requirement already satisfied: filelock in /usr/local/lib/python3.10/dist-packages (from torch>=1.10.1->qubee==0.10.0.0+aries2) (3.16.1)
Requirement already satisfied: nvidia-cuda-nvrtc-cu12==12.1.105 in /usr/local/lib/python3.10/dist-packages (from torch>=1.10.1->qubee==0.10.0.0+aries2) (12.1.105)
Requirement already satisfied: nvidia-cuda-cupti-cu12==12.1.105 in /usr/local/lib/python3.10/dist-packages (from torch>=1.10.1->qubee==0.10.0.0+aries2) (12.1.105)
Requirement already satisfied: nvidia-nccl-cu12==2.20.5 in /usr/local/lib/python3.10/dist-packages (from torch>=1.10.1->qubee==0.10.0.0+aries2) (2.20.5)
Requirement already satisfied: nvidia-nvtx-cu12==12.1.105 in /usr/local/lib/python3.10/dist-packages (from torch>=1.10.1->qubee==0.10.0.0+aries2) (12.1.105)
Requirement already satisfied: nvidia-cusolver-cu12==11.4.5.107 in /usr/local/lib/python3.10/dist-packages (from torch>=1.10.1->qubee==0.10.0.0+aries2) (11.4.5.107)
Requirement already satisfied: nvidia-nvjitlink-cu12 in /usr/local/lib/python3.10/dist-packages (from nvidia-cusolver-cu12==11.4.5.107->torch>=1.10.1->qubee==0.10.0.0+aries2) (12.6.85)
Requirement already satisfied: matplotlib>=2.1.0 in /usr/local/lib/python3.10/dist-packages (from pycocotools->qubee==0.10.0.0+aries2) (3.10.0)
Requirement already satisfied: wheel<1.0,>=0.23.0 in /usr/lib/python3/dist-packages (from astunparse>=1.6.0->tensorflow>=2.9->qubee==0.10.0.0+aries2) (0.37.1)
Requirement already satisfied: optree in /usr/local/lib/python3.10/dist-packages (from keras>=3.2.0->tensorflow>=2.9->qubee==0.10.0.0+aries2) (0.14.0)
Requirement already satisfied: rich in /usr/local/lib/python3.10/dist-packages (from keras>=3.2.0->tensorflow>=2.9->qubee==0.10.0.0+aries2) (13.9.4)
Requirement already satisfied: namex in /usr/local/lib/python3.10/dist-packages (from keras>=3.2.0->tensorflow>=2.9->qubee==0.10.0.0+aries2) (0.0.8)
Requirement already satisfied: contourpy>=1.0.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=2.1.0->pycocotools->qubee==0.10.0.0+aries2) (1.3.1)
Requirement already satisfied: kiwisolver>=1.3.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=2.1.0->pycocotools->qubee==0.10.0.0+aries2) (1.4.8)
Requirement already satisfied: fonttools>=4.22.0 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=2.1.0->pycocotools->qubee==0.10.0.0+aries2) (4.55.3)
Requirement already satisfied: pyparsing>=2.3.1 in /usr/lib/python3/dist-packages (from matplotlib>=2.1.0->pycocotools->qubee==0.10.0.0+aries2) (2.4.7)
Requirement already satisfied: python-dateutil>=2.7 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=2.1.0->pycocotools->qubee==0.10.0.0+aries2) (2.9.0.post0)
Requirement already satisfied: cycler>=0.10 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=2.1.0->pycocotools->qubee==0.10.0.0+aries2) (0.12.1)
Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.10/dist-packages (from requests<3,>=2.21.0->tensorflow>=2.9->qubee==0.10.0.0+aries2) (3.4.1)
Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests<3,>=2.21.0->tensorflow>=2.9->qubee==0.10.0.0+aries2) (3.10)
Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests<3,>=2.21.0->tensorflow>=2.9->qubee==0.10.0.0+aries2) (2024.12.14)
Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests<3,>=2.21.0->tensorflow>=2.9->qubee==0.10.0.0+aries2) (2.3.0)
Requirement already satisfied: markdown>=2.6.8 in /usr/local/lib/python3.10/dist-packages (from tensorboard<2.18,>=2.17->tensorflow>=2.9->qubee==0.10.0.0+aries2) (3.7)
Requirement already satisfied: tensorboard-data-server<0.8.0,>=0.7.0 in /usr/local/lib/python3.10/dist-packages (from tensorboard<2.18,>=2.17->tensorflow>=2.9->qubee==0.10.0.0+aries2) (0.7.2)
Requirement already satisfied: werkzeug>=1.0.1 in /usr/local/lib/python3.10/dist-packages (from tensorboard<2.18,>=2.17->tensorflow>=2.9->qubee==0.10.0.0+aries2) (3.1.3)
Requirement already satisfied: MarkupSafe>=2.0 in /usr/local/lib/python3.10/dist-packages (from jinja2->torch>=1.10.1->qubee==0.10.0.0+aries2) (3.0.2)
Requirement already satisfied: mpmath<1.4,>=1.1.0 in /usr/local/lib/python3.10/dist-packages (from sympy->torch>=1.10.1->qubee==0.10.0.0+aries2) (1.3.0)
Requirement already satisfied: markdown-it-py>=2.2.0 in /usr/local/lib/python3.10/dist-packages (from rich->keras>=3.2.0->tensorflow>=2.9->qubee==0.10.0.0+aries2) (3.0.0)
Requirement already satisfied: pygments<3.0.0,>=2.13.0 in /usr/local/lib/python3.10/dist-packages (from rich->keras>=3.2.0->tensorflow>=2.9->qubee==0.10.0.0+aries2) (2.19.1)
Requirement already satisfied: mdurl~=0.1 in /usr/local/lib/python3.10/dist-packages (from markdown-it-py>=2.2.0->rich->keras>=3.2.0->tensorflow>=2.9->qubee==0.10.0.0+aries2) (0.1.2)
Installing collected packages: qubee
Successfully installed qubee-0.10.0.0
WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv
root@40e9fbed9b89:/work# python - << 'PY'
import os, glob, numpy as np
from PIL import Image
import onnx
from qubee.calibration import make_calib_man
from qubee import mxq_compile

MODEL="vpeg_nano.onnx"
SRC  ="calib_imgs_gayatri"
CAL  ="calib_sr_gayatri_npy"

# pre_fn: RGB -> 256x256 -> float32 [0,1] (HWC)
def pre_fn(p):
    im=Image.open(p).convert("RGB").resize((256,256), Image.BICUBIC)
    return np.asarray(im, np.float32)/255.0

# clean + build calibration with official maker (required folder structure)
if os.path.isdir(CAL):
    import shutil; shutil.rmtree(CAL)
make_calib_man(pre_ftn=pre_fn,
               data_dir=SRC,
               save_dir=".",
               save_name=CAL,
               max_size=len(glob.glob(os.path.join(SRC,"*.png"))))

# detect input name & layout -> feed_dict
m=onnx.load(MODEL); vi=m.graph.input[0]
iname=vi.name
dims=[d.dim_value or 1 for d in vi.type.tensor_type.shape.dim]
if len(dims)==4 and dims[1] in (1,3):
PYint("OK") backend="onnx")eg_nano.mxq",,r itself)2)}         # NHWC
Making Numpy File: 100%|████████████████████████████████████████████████████████████████| 50/50 [00:00<00:00, 63.73it/s]
Preparing Calibration TXT File: 100%|███████████████████████████████████████████████| 50/50 [00:00<00:00, 927943.36it/s]
[⣾] Parsing deep learning model....[2025-11-26 09:23:08] qubee.model_dict.parser.backend.onnx._inference : [INFO] run onnx inference session
[⣻] Parsing deep learning model......[2025-11-26 09:23:09] qubee.model_dict.parser.backend.onnx._inference : [INFO] onnx inference session done.
[2025-11-26 09:23:09] qubee.model_dict.parser.parser : [INFO] [parser] Load and set dformat model done.
[⢿] Parsing deep learning model...[2025-11-26 09:23:09] qubee.model_dict.parser.parser : [INFO] [parser]
===========================================================
           Summary by Operator Type[Model Loaded]
===========================================================
        OpType        | Count | Unsupported | Supported(%)
----------------------+-------+-------------+--------------
Adding                |     10|           10|          0.00
Concatenate           |      4|            4|          0.00
Convolution           |     31|           31|          0.00
DepthwiseConvolution  |     17|           17|          0.00
Input                 |      1|            1|          0.00
Multiply              |      4|            4|          0.00
Output                |      1|            1|          0.00
Pooling               |      4|            4|          0.00
Pow                   |      4|            4|          0.00
ReduceMean            |      8|            8|          0.00
Relu                  |     16|           16|          0.00
Resize                |      4|            4|          0.00
Sigmoid               |      4|            4|          0.00
Split                 |      8|            8|          0.00
Sub                   |      4|            4|          0.00
----------------------+-------+-------------+--------------
All                   |    120|          120|          0.00
===========================================================
[2025-11-26 09:23:09] qubee.model_dict.parser.parser : [INFO] [parser]
Number of Subgraphs: 1
graph order: [0]
stateful_lstm_subgraphs: {}
backend: onnx
model inputs: ['name: input, src_shape: (1,3,256,256), dataformat: NCHW, origin_name: ']
model outputs: ['name: output, src_shape: (1,3,256,256), dataformat: NCHW, origin_name: ']
[2025-11-26 09:23:09] qubee.model_dict.parser.parser : [INFO] outputs:

[⣷] Parsing deep learning model...
[2025-11-26 09:23:10] qubee.model_dict.parser.parser : [INFO] [parser]
===========================================================
Summary by Operator Type[HL compilation done. Device=Aries2]
===========================================================
        OpType        | Count | Unsupported | Supported(%)
----------------------+-------+-------------+--------------
Adding                |     10|            0|        100.00
Concatenate           |      4|            0|        100.00
Convolution           |     35|            0|        100.00
DepthwiseConvolution  |     17|            0|        100.00
Input                 |      1|            0|        100.00
Multiply              |      4|            0|        100.00
Output                |      1|            0|        100.00
Pooling               |     12|            0|        100.00
Pow                   |      4|            0|        100.00
Relu                  |     16|            0|        100.00
Resize                |      8|            0|        100.00
Sigmoid               |      4|            0|        100.00
Sub                   |      4|            0|        100.00
----------------------+-------+-------------+--------------
All                   |    120|            0|        100.00
===========================================================
[2025-11-26 09:23:10] qubee.model_dict.parser.parser : [INFO] [parser]
Number of Subgraphs: 1
graph order: [0]
stateful_lstm_subgraphs: {}
backend: onnx
model inputs: ['name: input_0, src_shape: (1,256,256,3), dataformat: NHWC, origin_name: input']
model outputs: ['name: add_1, src_shape: (1,256,256,3), dataformat: NHWC, origin_name: output']
[2025-11-26 09:23:10] qubee.model_dict.parser.parser : [INFO] outputs:

[2025-11-26 09:23:10] qubee.model_dict.parser.parser : [INFO] vpeg_nano model's number of operations 6.4173 GOPS, 3.2086 MACs
[2025-11-26 09:23:10] qubee.model_dict.parser.parser : [INFO] ================================================================================
[2025-11-26 09:23:10] qubee.model_dict.parser.parser : [INFO]   Supported: 6.4173 GOPS, 3.2086 MACs
[2025-11-26 09:23:10] qubee.model_dict.parser.parser : [INFO]   Unsupported: 0.0000 GOPS, 0.0000 MACs
[2025-11-26 09:23:10] qubee.model_dict.parser.parser : [INFO] ================================================================================
[2025-11-26 09:23:10] qubee.compiler.compiler : [INFO] write intermediate file: /tmp/qubee/frontend/95faeb7f-10e4-4ffe-b15e-6a5ec70a53bf/model.mblt done.
✔ Parsing deep learning model... Done!
Preparing Calibration TXT File: 100%|██████████████████████████████████████████████| 50/50 [00:00<00:00, 1651300.79it/s]
[2025-11-26 09:23:10.904] Setting Quantizer Config...
OPTQ config is found
optq apply false
minOutputDiff config is found
transformerQuant is found
bitAllocation config is found
quantLayer config is found
llm config is found
reduceGPU config is found
[2025-11-26 09:23:10.905] Performing Quantization...
[2025-11-26 09:23:10.919] complete high-level model optimizing
[2025-11-26 09:23:10.919] Try to load calibration data set from dataset txt. Dataset txt file path = /tmp/tmpbc31jteq.txt
[2025-11-26 09:23:10.919] There are 50 files in txt file.
[2025-11-26 09:23:11.393] Complete load calibration data. Success = 50, Fail = 0
[2025-11-26 09:23:11.393] Load calibration data Time = 0.47385922 sec

================ Input Information ===============
Input Name        = input_0
Input Shape       = [256, 256, 3]
Reshaped Shape    = [256, 256, 3]
==================================================

================ Output Information ==============
Output Name       = add_1
Output Shape      = [256, 256, 3]
==================================================
[2025-11-26 09:23:35.141] Compiling the Quantized model...
[2025-11-26 09:23:35.142] <<<<<<<<<<<<<<<<<<<<<<[Banckend Compiler] Runtime Config Initialized: 1>>>>>>>>>>>>>>>>>>>>>>
[2025-11-26 09:23:35.143] HW: Aries2, Build Mode: Single, target: 00
[2025-11-26 09:23:35.151] optimize network finished
load_weights [**************************] 100% layer946
init_div [******************************] 100%
opt_div [*******************************] 100%
[2025-11-26 09:23:35.236] optimize division finished
rearrange weights [*********************] 100%
[2025-11-26 09:23:35.670] Build Finished.
[2025-11-26 09:23:35.674] <<<<<<<<<<<<<<<<<<<<<<[Banckend Compiler] Runtime Config Initialized: 2>>>>>>>>>>>>>>>>>>>>>>
[2025-11-26 09:23:35.675] HW: Aries2, Build Mode: Single, target: 01
[2025-11-26 09:23:35.683] optimize network finished
load_weights [**************************] 100% layer101
rearrange weights [*********************] 100%
[2025-11-26 09:23:36.084] Build Finished.
[2025-11-26 09:23:36.090] <<<<<<<<<<<<<<<<<<<<<<[Banckend Compiler] Runtime Config Initialized: 3>>>>>>>>>>>>>>>>>>>>>>
[2025-11-26 09:23:36.091] HW: Aries2, Build Mode: Single, target: 02
[2025-11-26 09:23:36.099] optimize network finished
load_weights [**************************] 100% layer128
rearrange weights [*********************] 100%
[2025-11-26 09:23:36.509] Build Finished.
[2025-11-26 09:23:36.518] <<<<<<<<<<<<<<<<<<<<<<[Banckend Compiler] Runtime Config Initialized: 4>>>>>>>>>>>>>>>>>>>>>>
[2025-11-26 09:23:36.519] HW: Aries2, Build Mode: Single, target: 03
[2025-11-26 09:23:36.527] optimize network finished
load_weights [**************************] 100% layer103
rearrange weights [*********************] 100%
[2025-11-26 09:23:36.940] Build Finished.
[2025-11-26 09:23:36.950] <<<<<<<<<<<<<<<<<<<<<<[Banckend Compiler] Runtime Config Initialized: 5>>>>>>>>>>>>>>>>>>>>>>
[2025-11-26 09:23:36.952] HW: Aries2, Build Mode: Single, target: 10
[2025-11-26 09:23:36.960] optimize network finished
load_weights [**************************] 100% layer641
rearrange weights [*********************] 100%
[2025-11-26 09:23:37.429] Build Finished.
[2025-11-26 09:23:37.444] <<<<<<<<<<<<<<<<<<<<<<[Banckend Compiler] Runtime Config Initialized: 6>>>>>>>>>>>>>>>>>>>>>>
[2025-11-26 09:23:37.446] HW: Aries2, Build Mode: Single, target: 11
[2025-11-26 09:23:37.454] optimize network finished
load_weights [**************************] 100% layer137
rearrange weights [*********************] 100%
[2025-11-26 09:23:37.895] Build Finished.
[2025-11-26 09:23:37.913] <<<<<<<<<<<<<<<<<<<<<<[Banckend Compiler] Runtime Config Initialized: 7>>>>>>>>>>>>>>>>>>>>>>
[2025-11-26 09:23:37.914] HW: Aries2, Build Mode: Single, target: 12
[2025-11-26 09:23:37.922] optimize network finished
load_weights [**************************] 100% layer139
rearrange weights [*********************] 100%
[2025-11-26 09:23:38.339] Build Finished.
[2025-11-26 09:23:38.361] <<<<<<<<<<<<<<<<<<<<<<[Banckend Compiler] Runtime Config Initialized: 8>>>>>>>>>>>>>>>>>>>>>>
[2025-11-26 09:23:38.363] HW: Aries2, Build Mode: Single, target: 13
[2025-11-26 09:23:38.372] optimize network finished
load_weights [**************************] 100% layer134
rearrange weights [*********************] 100%
[2025-11-26 09:23:38.785] Build Finished.
[2025-11-26 09:23:38.824] Elaborating MXQ...
[2025-11-26 09:23:38.830] Exporting MXQ...
[2025-11-26 09:23:38.849] Verifying exported MXQ file...
[2025-11-26 09:23:38.987] Compilation was successful.
OK
root@40e9fbed9b89:/work#



================================================================================================================================================

Install the latest PowerShell for new features and improvements! https://aka.ms/PSWindows

PS C:\Users\018241340> cd C:\NPU_Projects
PS C:\NPU_Projects> python3.12 inference_updated_gayatri.py
CPU failed: No module named 'onnxruntime'
* PCIe Device Driver connection details.
        > Driver version : 1.7.4 (Revision 1)
        > PCIe Cards connection information.
                 - Main-System(VID:0x209F,DID:0x0000), Sub-System(VID:0x0401,DID:0x1093), PCIe 3.0 - 8 Lanes

I1125 16:24:46.459 6564 model_impl.cc:846] Model constructed. (vpeg_nano.mxq)
I1125 16:24:46.486 6564 model_impl.cc:1135] Model launched.
I1125 16:24:48.487 6564 model_impl.cc:1154] Model disposed.
NPU 19.77 ms/img (50.6 img/s)
PSNR(rgb) mean: 22.61 dB over 100 images
PS C:\NPU_Projects>